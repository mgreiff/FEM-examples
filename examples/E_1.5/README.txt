Complete!

The algorithm has been checked by lab supervisors, note that the
contribution of the spring is added in g_bar.m.